package org.talend.hackathon;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

public class TestGetSchema {

    private String bearer = "eyJraWQiOiJpYW0tb2lkYy1jbG91ZCIsImFsZyI6IlJTMjU2In0.eyJqdGkiOiI3OTM4ZWM2ZmRiMzU3NjUzYzA5YjFkNDJlNGJmN2JmYTA4NDExYTk0MzkwMjQ0YzY5Y2ExOGIyZThkMTU1YjhlIiwiY2xpZW50X2lkIjoiR2RPWW0yRWRjSGw3YlAiLCJpYXQiOjE2MTE2NjMwOTIsImV4cCI6MTYxMTY2NDU5Miwic3ViIjoiM2VlOTQ1NDAtOGFmOC00MjZiLWE5NDUtNDA4YWY4ODI2YjlmIiwidXNlcm5hbWUiOiJza2VybWFib25AZGF0YXByZXAuY29tIiwiaXNzIjoiaHR0cHM6Ly9pYW0uYXQuY2xvdWQudGFsZW5kLmNvbS9vaWRjIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2tlcm1hYm9uQGRhdGFwcmVwLmNvbSIsImxvZ2luIjoic2tlcm1hYm9uQGRhdGFwcmVwLmNvbSIsIm5hbWUiOiJTdMOpcGhhbmUgS2VybWFib24iLCJnaXZlbl9uYW1lIjoiU3TDqXBoYW5lIiwiZmFtaWx5X25hbWUiOiJLZXJtYWJvbiIsImVtYWlsIjoic2tlcm1hYm9uQHRhbGVuZC5jb20iLCJlbnRpdGxlbWVudHMiOiJUTUNfT1BFUkFUT1IsQ09OTkVDVElPTl9VUERBVEUsVE1DX0dST1VQX01BTkFHRU1FTlQsVE1DX1BPTElDWV9QQVNTV09SRCxURFFfU0VNQU5USUNfVFlQRV9WSUVXLERBVEFTRVRfQVRUUklCVVRFU19NQU5BR0UsREFUQVNFVF9SRUFELERBVEFTRVRfU0hBUkUsVERRX1NFTUFOVElDX1RZUEVfREVMRVRFLFREU19DQU1QQUlHTl9DUkVBVEUsVE1DX1BST01PVElPTl9FWEVDVVRJT04sREFUQVNFVF9TQ0hFTUFfVVBEQVRFLENVU1RPTV9BVFRSSUJVVEVfQ1JFQVRFLFREU19UQVNLX0NSRUFURSxURFBfREFUQVNFVF9DRVJUSUZZLENPTk5FQ1RJT05fUkVBRCxUTUNfUFJPSkVDVF9NQU5BR0VNRU5ULFREUF9GVUxMX1JVTl9QRVJGT1JNLFREUF9EQVRBU0VUX1BFUkZPUk1fTElWRSxUTUNfRU5WSVJPTk1FTlRfTUFOQUdFTUVOVCxURFNfVEFTS19SRUFELENPTk5FQ1RJT05fU0hBUkUsVERTX0FTU0lHTkVEX1RBU0tfUkVBRCxEQVRBU0VUX0NFUlRJRlksVERTX1NDSEVNQV9DUkVBVEUsVERTX1NDSEVNQV9VUERBVEUsVE1DX0NMVVNURVJfTUFOQUdFTUVOVCxURFNfVU5BU1NJR05FRF9UQVNLX0FTU0lHTixURFNfQVNTSUdORURfVEFTS19NRVRBREFUQV9VUERBVEUsVERTX1NDSEVNQV9ERUxFVEUsVERRX1NFTUFOVElDX1RZUEVfTElTVCxEQVRBU0VUX1RBR1NfTUFOQUdFLFRJUEFBU19FTlRJVExFTUVOVF9BVVRIRU5USUNBVEVELFRNQ19ST0xFX01BTkFHRU1FTlQsREFUQVNFVF9BRFZBTkNFRF9TRUFSQ0gsVERRX1NFTUFOVElDX1RZUEVfUFVCTElTSCxURFBfQkFTSUMsQ1VTVE9NX0FUVFJJQlVURV9SRUFELFRNQ19TU09fTUFOQUdFTUVOVCxEQVRBU0VUX1NBTVBMRV9VUERBVEUsVERTX1RBU0tfVVBEQVRFLFREU19VU0VSU19SRUFELFREU19BU1NJR05FRF9UQVNLX0RBVEFfVVBEQVRFLENPTk5FQ1RJT05fQ1JFQVRFLFREU19DQU1QQUlHTl9MSVNULENVU1RPTV9BVFRSSUJVVEVfREVMRVRFLFREU19VTkFTU0lHTkVEX1RBU0tfUkVBRCxURFFfU0VNQU5USUNfVFlQRV9DUkVBVEUsVERQX1BSRVBfVkVSU0lPTl9DUkVBVEUsQVVESVRfTE9HU19WSUVXLFRNQ19SVU5fUFJPRklMRV9NQU5BR0VNRU5ULFRNQ19VU0VSX01BTkFHRU1FTlQsQ1VTVE9NX0FUVFJJQlVURV9VUERBVEUsVERTX1RBU0tfREVMRVRFLFNUVURJT19FTlRJVExFTUVOVF9TVFVESU9fREVWRUxPUEVSLFREU19UQVNLX1JFQURfQllfRVhURVJOQUxfSUQsVERTX0NBTVBBSUdOX0RFTEVURSxURFNfVEFTS19ISVNUT1JZX1JFQUQsVERQX1RDT01QX1VTRSxURFFfU0VNQU5USUNfVFlQRV9FRElULFRNQ19TVUJTQ1JJUFRJT05fTUFOQUdFTUVOVCxEQVRBU0VUX0RFTEVURSxURFNfQVNTSUdORURfVEFTS19BU1NJR04sVERTX1RBU0tfQVNTSUdOLFREU19DQU1QQUlHTl9SRUFELFRNQ19DTE9VRF9DT05GSUdVUkFUSU9OX01BTkFHRU1FTlQsVE1DX1NUQVRJQ19JUF9NQU5BR0VNRU5ULERBVEFTRVRfQ1JFQVRFLFREU19TQ0hFTUFfUkVBRCxDT05ORUNUSU9OX0RFTEVURSxUTUNfRVhQT1JUX0xPR1NfTUFOQUdFTUVOVCxURFNfU0NIRU1BX0xJU1QsREFUQVNFVF9VUERBVEUsVERTX1RBU0tfTUVUQURBVEFfVVBEQVRFLFRNQ19DT05GSUdVUkFUSU9OX05FWFVTX1VTRVJMSUJTLFRNQ19QSVBFTElORV9NQU5BR0VNRU5ULFREU19DQU1QQUlHTl9VUERBVEUiLCJ0ZW5hbnRfaWQiOiJmZmE4OTVkYy01ZDMxLTRkZGMtYjkwYS0yMGE0NDFhZDZiMDUiLCJ0ZW5hbnRfbmFtZSI6ImRhdGFwcmVwLmNvbSIsImdyb3VwX2lkcyI6WyIwNDkxNDhhYy00ZGE4LTQ3MDItOTE0OC1hYzRkYTgxNzAyMTIiXSwicHJlZmVycmVkX2xhbmd1YWdlIjoiZnIiLCJhcHBsaWNhdGlvbnMiOlsiVERRIiwiVERQIiwiVERDIiwiVERTIiwiSUFNIiwiVE1DIiwiREFUQVNFVFMiLCJTVFVESU8iXSwidGltZXpvbmUiOiJFdXJvcGUvTGp1YmxqYW5hIiwicGVuZG9fdXNlcl9pZCI6InNrZXJtYWJvbkBkYXRhcHJlcC5jb20iLCJwZW5kb19jb21wYW55X25hbWUiOiJkYXRhcHJlcC5jb20iLCJwZW5kb19kYXRhY2VudGVyIjoidXMiLCJzdWJzY3JpcHRpb25fdHlwZSI6Ikh5YnJpZCBFZGl0aW9uIiwic3Vic2NyaXB0aW9uX3N0YXR1cyI6IkV2YWx1YXRpb24iLCJzdXBwb3J0X2xldmVsIjoiQ29tbXVuaXR5Iiwic2FsZXNfZm9yY2VfY29udGFjdF9pZCI6bnVsbCwic2FsZXNfZm9yY2VfYWNjb3VudF9pZCI6bnVsbCwiaXBjX2VuYWJsZWQiOnRydWV9.e2stOxzpNuBlQEtUU8hQOJ28GlWT5yQkCidHGlNnwCwWutQWWzGl0UD1yTDJiqoNtg2ZRh4XMw66rn7CGhAOWXvfFn5DoeiuquyFsCA3aBuwx0F0N75DIhLZnHpXwM_JrLeZj368DDLR9o4s5BVHKDBlvJVNJderqGuKhrleUH7T_a-0SXE29qeCA4l5k9uK9kiKHpoMUa_Po9J5n5OrKv1xuVgz9HcSfodgAHRp1BG9Su2ZcYbnqx-0Z_aehntE7QiCPZ7uTCe08jvMNVnJ0uQT0E4BP34RWX6ZpFy3CPdD45LziL_5n8AEfYHQhO9ico1mwEWpVBKMvrGxpS058g";

    @Test
    public void testGetSchema() {
        GetSchema getSchema = new GetSchema("https://tdp.at.cloud.talend.com", "https://tdp.at.cloud.talend.com");

        Schema schema = getSchema.getSchema("8779cbf2-b507-4072-afd7-e6af66c2da78", bearer);

        Assertions.assertNotNull(schema);
    }

    @Test
    public void testLogin() {
        GetSchema getSchema = new GetSchema("https://tdp.at.cloud.talend.com", "https://tdp.at.cloud.talend.com");
        String bearer = getSchema.getBearer("skermabon@dataprep.com", "Admin123+");

        Assertions.assertNotNull(bearer);
    }

    @Test
    public void testAll() {
        GetSchema getSchema = new GetSchema("https://tdp.at.cloud.talend.com", "https://tdp.at.cloud.talend.com");

        Schema schema = getSchema.getSchema("8779cbf2-b507-4072-afd7-e6af66c2da78", getSchema.getBearer("skermabon@dataprep.com", "Admin123+"));
        Assertions.assertNotNull(schema);
    }
}
